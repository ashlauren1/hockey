from ratelimit import limits, sleep_and_retry
import requests
from bs4 import BeautifulSoup
import pandas as pd
from io import StringIO
import time
import os
from datetime import datetime

# Define rate limit parameters
REQUESTS_PER_MINUTE = 20
ONE_MINUTE = 60

@sleep_and_retry
@limits(calls=REQUESTS_PER_MINUTE, period=ONE_MINUTE)
def fetch_webpage(url):
    response = requests.get(url)
    response.raise_for_status()
    return response.text

def convert_toi_to_decimal(toi_str):
    """Convert TOI from 'mm:ss' to decimal minutes."""
    try:
        minutes, seconds = map(int, toi_str.split(':'))
        return minutes + seconds / 60
    except ValueError:
        return None

def extract_date_from_game_id(game_id):
    date_str = game_id[:8]
    return datetime.strptime(date_str, "%Y%m%d").strftime("%m/%d/%Y")

# Define the game IDs, home teams, and away teams
games_info = {
    "202310100TBL": ("TBL", "NSH"),
    "202310100PIT": ("PIT", "CHI"),
    "202310100VEG": ("VEG", "SEA"),
    "202310110CAR": ("CAR", "OTT"),
    "202310110TOR": ("TOR", "MTL"),
    "202310110BOS": ("BOS", "CHI"),
    "202310110CGY": ("CGY", "WPG"),
    "202310110LAK": ("LAK", "COL"),
    "202310110VAN": ("VAN", "EDM"),
    "202310120BUF": ("BUF", "NYR"),
    "202310120CBJ": ("CBJ", "PHI"),
    "202310120NJD": ("NJD", "DET"),
    "202310120DAL": ("DAL", "STL"),
    "202310120MIN": ("MIN", "FLA"),
    "202310120NSH": ("NSH", "SEA"),
    "202310120SJS": ("SJS", "VEG"),
    "202310130NJD": ("NJD", "ARI"),
    "202310130WSH": ("WSH", "PIT"),
    "202310140OTT": ("OTT", "PHI"),
    "202310140WPG": ("WPG", "FLA"),
    "202310140BOS": ("BOS", "NSH"),
    "202310140CBJ": ("CBJ", "NYR"),
    "202310140DET": ("DET", "TBL"),
    "202310140MTL": ("MTL", "CHI"),
    "202310140PIT": ("PIT", "CGY"),
    "202310140TOR": ("TOR", "MIN"),
    "202310140NYI": ("NYI", "BUF"),
    "202310140STL": ("STL", "SEA"),
    "202310140EDM": ("EDM", "VAN"),
    "202310140SJS": ("SJS", "COL"),
    "202310140VEG": ("VEG", "ANA"),
    "202310140LAK": ("LAK", "CAR"),
    "202310150OTT": ("OTT", "TBL"),
    "202310150ANA": ("ANA", "CAR"),
    "202310160CBJ": ("CBJ", "DET"),
    "202310160NJD": ("NJD", "FLA"),
    "202310160NYR": ("NYR", "ARI"),
    "202310160TOR": ("TOR", "CHI"),
    "202310160WSH": ("WSH", "CGY"),
    "202310170BUF": ("BUF", "TBL"),
    "202310170MTL": ("MTL", "MIN"),
    "202310170PHI": ("PHI", "VAN"),
    "202310170NYI": ("NYI", "ARI"),
    "202310170NSH": ("NSH", "EDM"),
    "202310170WPG": ("WPG", "LAK"),
    "202310170SEA": ("SEA", "COL"),
    "202310170SJS": ("SJS", "CAR"),
    "202310170VEG": ("VEG", "DAL"),
    "202310180OTT": ("OTT", "WSH"),
    "202310180DET": ("DET", "PIT"),
    "202310190BUF": ("BUF", "CGY"),
    "202310190FLA": ("FLA", "TOR"),
    "202310190NYR": ("NYR", "NSH"),
    "202310190PHI": ("PHI", "EDM"),
    "202310190TBL": ("TBL", "VAN"),
    "202310190MIN": ("MIN", "LAK"),
    "202310190STL": ("STL", "ARI"),
    "202310190WPG": ("WPG", "VEG"),
    "202310190ANA": ("ANA", "DAL"),
    "202310190SEA": ("SEA", "CAR"),
    "202310190COL": ("COL", "CHI"),
    "202310190SJS": ("SJS", "BOS"),
    "202310200CBJ": ("CBJ", "CGY"),
    "202310200NYI": ("NYI", "NJD"),
    "202310210OTT": ("OTT", "DET"),
    "202310210ARI": ("ARI", "ANA"),
    "202310210BUF": ("BUF", "NYI"),
    "202310210FLA": ("FLA", "VAN"),
    "202310210MTL": ("MTL", "WSH"),
    "202310210TBL": ("TBL", "TOR"),
    "202310210CHI": ("CHI", "VEG"),
    "202310210DAL": ("DAL", "PHI"),
    "202310210MIN": ("MIN", "CBJ"),
    "202310210NSH": ("NSH", "SJS"),
    "202310210STL": ("STL", "PIT"),
    "202310210COL": ("COL", "CAR"),
    "202310210EDM": ("EDM", "WPG"),
    "202310210SEA": ("SEA", "NYR"),
    "202310210LAK": ("LAK", "BOS"),
    "202310220DET": ("DET", "CGY"),
    "202310220ANA": ("ANA", "BOS"),
    "202310230BUF": ("BUF", "MTL"),
    "202310240WSH": ("WSH", "TOR"),
    "202310240CBJ": ("CBJ", "ANA"),
    "202310240OTT": ("OTT", "BUF"),
    "202310240TBL": ("TBL", "CAR"),
    "202310240MTL": ("MTL", "NJD"),
    "202310240PIT": ("PIT", "DAL"),
    "202310240FLA": ("FLA", "SJS"),
    "202310240NYI": ("NYI", "COL"),
    "202310240DET": ("DET", "SEA"),
    "202310240CHI": ("CHI", "BOS"),
    "202310240WPG": ("WPG", "STL"),
    "202310240MIN": ("MIN", "EDM"),
    "202310240NSH": ("NSH", "VAN"),
    "202310240CGY": ("CGY", "NYR"),
    "202310240LAK": ("LAK", "ARI"),
    "202310240VEG": ("VEG", "PHI"),
    "202310250NJD": ("NJD", "WSH"),
    "202310260BOS": ("BOS", "ANA"),
    "202310260CAR": ("CAR", "SEA"),
    "202310260DET": ("DET", "WPG"),
    "202310260MTL": ("MTL", "CBJ"),
    "202310260PHI": ("PHI", "MIN"),
    "202310260PIT": ("PIT", "COL"),
    "202310260TBL": ("TBL", "SJS"),
    "202310260NYI": ("NYI", "OTT"),
    "202310260DAL": ("DAL", "TOR"),
    "202310260CGY": ("CGY", "STL"),
    "202310260EDM": ("EDM", "NYR"),
    "202310270VEG": ("VEG", "CHI"),
    "202310270CAR": ("CAR", "SJS"),
    "202310270NJD": ("NJD", "BUF"),
    "202310270WSH": ("WSH", "MIN"),
    "202310270ARI": ("ARI", "LAK"),
    "202310270VAN": ("VAN", "STL"),
    "202310280PHI": ("PHI", "ANA"),
    "202310280FLA": ("FLA", "SEA"),
    "202310280BOS": ("BOS", "DET"),
    "202310280CBJ": ("CBJ", "NYI"),
    "202310280MTL": ("MTL", "WPG"),
    "202310280NSH": ("NSH", "TOR"),
    "202310280PIT": ("PIT", "OTT"),
    "202310280VAN": ("VAN", "NYR"),
    "202310280LAK": ("LAK", "VEG"),
    "202310290BUF": ("BUF", "COL"),
    "202310290NJD": ("NJD", "MIN"),
    "202310290WSH": ("WSH", "SJS"),
    "202310290EDM": ("EDM", "CGY"),
    "202310300BOS": ("BOS", "FLA"),
    "202310300PHI": ("PHI", "CAR"),
    "202310300PIT": ("PIT", "ANA"),
    "202310300TBL": ("TBL", "SEA"),
    "202310300NYI": ("NYI", "DET"),
    "202310300WPG": ("WPG", "NYR"),
    "202310300DAL": ("DAL", "CBJ"),
    "202310300ARI": ("ARI", "CHI"),
    "202310300VEG": ("VEG", "MTL"),
    "202310310TOR": ("TOR", "LAK"),
    "202310310VAN": ("VAN", "NSH"),
    "202311010PHI": ("PHI", "BUF"),
    "202311010CGY": ("CGY", "DAL"),
    "202311010COL": ("COL", "STL"),
    "202311010ANA": ("ANA", "ARI"),
    "202311020BOS": ("BOS", "TOR"),
    "202311020CBJ": ("CBJ", "TBL"),
    "202311020DET": ("DET", "FLA"),
    "202311020NYR": ("NYR", "CAR"),
    "202311020OTT": ("OTT", "LAK"),
    "202311020WSH": ("WSH", "NYI"),
    "202311020MIN": ("MIN", "NJD"),
    "202311020EDM": ("EDM", "DAL"),
    "202311020ARI": ("ARI", "MTL"),
    "202311020SEA": ("SEA", "NSH"),
    "202311020VEG": ("VEG", "WPG"),
    "202311020SJS": ("SJS", "VAN"),
    "202311030BUF": ("BUF", "PHI"),
    "202311030STL": ("STL", "NJD"),
    "202311040EDM": ("EDM", "NSH"),
    "202311040ARI": ("ARI", "WPG"),
    "202311040DET": ("DET", "BOS"),
    "202311040OTT": ("OTT", "TBL"),
    "202311040PHI": ("PHI", "LAK"),
    "202311040STL": ("STL", "MTL"),
    "202311040TOR": ("TOR", "BUF"),
    "202311040WSH": ("WSH", "CBJ"),
    "202311040NYI": ("NYI", "CAR"),
    "202311040CHI": ("CHI", "FLA"),
    "202311040MIN": ("MIN", "NYR"),
    "202311040SEA": ("SEA", "CGY"),
    "202311040SJS": ("SJS", "PIT"),
    "202311040VAN": ("VAN", "DAL"),
    "202311040VEG": ("VEG", "COL"),
    "202311050CHI": ("CHI", "NJD"),
    "202311050ANA": ("ANA", "VEG"),
    "202311060FLA": ("FLA", "CBJ"),
    "202311060TOR": ("TOR", "TBL"),
    "202311060DAL": ("DAL", "BOS"),
    "202311060VAN": ("VAN", "EDM"),
    "202311070CAR": ("CAR", "BUF"),
    "202311070MTL": ("MTL", "TBL"),
    "202311070NYI": ("NYI", "MIN"),
    "202311070NYR": ("NYR", "DET"),
    "202311070STL": ("STL", "WPG"),
    "202311070ARI": ("ARI", "SEA"),
    "202311070CGY": ("CGY", "NSH"),
    "202311070ANA": ("ANA", "PIT"),
    "202311070COL": ("COL", "NJD"),
    "202311070SJS": ("SJS", "PHI"),
    "202311080TOR": ("TOR", "OTT"),
    "202311080WSH": ("WSH", "FLA"),
    "202311080VEG": ("VEG", "LAK"),
    "202311090BOS": ("BOS", "NYI"),
    "202311090CBJ": ("CBJ", "DAL"),
    "202311090DET": ("DET", "MTL"),
    "202311090NYR": ("NYR", "MIN"),
    "202311090OTT": ("OTT", "VAN"),
    "202311090TBL": ("TBL", "CHI"),
    "202311090STL": ("STL", "ARI"),
    "202311090WPG": ("WPG", "NSH"),
    "202311090COL": ("COL", "SEA"),
    "202311090LAK": ("LAK", "PIT"),
    "202311090SJS": ("SJS", "EDM"),
    "202311100BUF": ("BUF", "MIN"),
    "202311100FLA": ("FLA", "CAR"),
    "202311100NJD": ("NJD", "WSH"),
    "202311100TOR": ("TOR", "CGY"),
    "202311100ANA": ("ANA", "PHI"),
    "202311100VEG": ("VEG", "SJS"),
    "202311110DET": ("DET", "CBJ"),
    "202311110WPG": ("WPG", "DAL"),
    "202311110MTL": ("MTL", "BOS"),
    "202311110OTT": ("OTT", "CGY"),
    "202311110TBL": ("TBL", "CAR"),
    "202311110TOR": ("TOR", "VAN"),
    "202311110NYI": ("NYI", "WSH"),
    "202311110PIT": ("PIT", "BUF"),
    "202311110NSH": ("NSH", "ARI"),
    "202311110COL": ("COL", "STL"),
    "202311110SEA": ("SEA", "EDM"),
    "202311110LAK": ("LAK", "PHI"),
    "202311120FLA": ("FLA", "CHI"),
    "202311120MIN": ("MIN", "DAL"),
    "202311120MTL": ("MTL", "VAN"),
    "202311120NYR": ("NYR", "CBJ"),
    "202311120ANA": ("ANA", "SJS"),
    "202311130EDM": ("EDM", "NYI"),
    "202311130SEA": ("SEA", "COL"),
    "202311140BUF": ("BUF", "BOS"),
    "202311140CBJ": ("CBJ", "PIT"),
    "202311140MTL": ("MTL", "CGY"),
    "202311140WSH": ("WSH", "VEG"),
    "202311140DAL": ("DAL", "ARI"),
    "202311140NSH": ("NSH", "ANA"),
    "202311140STL": ("STL", "TBL"),
    "202311140WPG": ("WPG", "NJD"),
    "202311140SJS": ("SJS", "FLA"),
    "202311150CAR": ("CAR", "PHI"),
    "202311150EDM": ("EDM", "SEA"),
    "202311150COL": ("COL", "ANA"),
    "202311150VAN": ("VAN", "NYI"),
    "202311160OTT": ("OTT", "DET"),
    "202311160CBJ": ("CBJ", "ARI"),
    "202311160MTL": ("MTL", "VEG"),
    "202311160PIT": ("PIT", "NJD"),
    "202311160CHI": ("CHI", "TBL"),
    "202311160CGY": ("CGY", "VAN"),
    "202311160SEA": ("SEA", "NYI"),
    "202311160LAK": ("LAK", "FLA"),
    "202311160SJS": ("SJS", "STL"),
    "202311170DET": ("DET", "TOR"),
    "202311170WPG": ("WPG", "BUF"),
    "202311170ANA": ("ANA", "FLA"),
    "202311180OTT": ("OTT", "MIN"),
    "202311180PHI": ("PHI", "VEG"),
    "202311180NSH": ("NSH", "CHI"),
    "202311180TBL": ("TBL", "EDM"),
    "202311180BOS": ("BOS", "MTL"),
    "202311180CAR": ("CAR", "PIT"),
    "202311180CGY": ("CGY", "NYI"),
    "202311180NJD": ("NJD", "NYR"),
    "202311180WPG": ("WPG", "ARI"),
    "202311180WSH": ("WSH", "CBJ"),
    "202311180DAL": ("DAL", "COL"),
    "202311180VAN": ("VAN", "SEA"),
    "202311180LAK": ("LAK", "STL"),
    "202311190MIN": ("MIN", "TOR"),
    "202311190PHI": ("PHI", "CBJ"),
    "202311190PIT": ("PIT", "VEG"),
    "202311190CHI": ("CHI", "BUF"),
    "202311190ANA": ("ANA", "STL"),
    "202311200FLA": ("FLA", "EDM"),
    "202311200TBL": ("TBL", "BOS"),
    "202311200DAL": ("DAL", "NYR"),
    "202311200NSH": ("NSH", "COL"),
    "202311200ARI": ("ARI", "LAK"),
    "202311200SEA": ("SEA", "CGY"),
    "202311200VAN": ("VAN", "SJS"),
    "202311220CAR": ("CAR", "EDM"),
    "202311220CBJ": ("CBJ", "CHI"),
    "202311220DET": ("DET", "NJD"),
    "202311220FLA": ("FLA", "BOS"),
    "202311220PIT": ("PIT", "NYR"),
    "202311220TBL": ("TBL", "WPG"),
    "202311220WSH": ("WSH", "BUF"),
    "202311220NYI": ("NYI", "PHI"),
    "202311220ARI": ("ARI", "STL"),
    "202311220NSH": ("NSH", "CGY"),
    "202311220DAL": ("DAL", "VEG"),
    "202311220ANA": ("ANA", "MTL"),
    "202311220COL": ("COL", "VAN"),
    "202311220SEA": ("SEA", "SJS"),
    "202311240BOS": ("BOS", "DET"),
    "202311240PHI": ("PHI", "NYR"),
    "202311240CHI": ("CHI", "TOR"),
    "202311240NJD": ("NJD", "CBJ"),
    "202311240STL": ("STL", "NSH"),
    "202311240WSH": ("WSH", "EDM"),
    "202311240ANA": ("ANA", "LAK"),
    "202311240SJS": ("SJS", "MTL"),
    "202311240BUF": ("BUF", "PIT"),
    "202311240OTT": ("OTT", "NYI"),
    "202311240CAR": ("CAR", "TBL"),
    "202311240FLA": ("FLA", "WPG"),
    "202311240DAL": ("DAL", "CGY"),
    "202311240MIN": ("MIN", "COL"),
    "202311240SEA": ("SEA", "VAN"),
    "202311250NYR": ("NYR", "BOS"),
    "202311250LAK": ("LAK", "MTL"),
    "202311250NJD": ("NJD", "BUF"),
    "202311250PIT": ("PIT", "TOR"),
    "202311250NYI": ("NYI", "PHI"),
    "202311250COL": ("COL", "CGY"),
    "202311250SJS": ("SJS", "VAN"),
    "202311250VEG": ("VEG", "ARI"),
    "202311260DET": ("DET", "MIN"),
    "202311260CHI": ("CHI", "STL"),
    "202311260CAR": ("CAR", "CBJ"),
    "202311260NSH": ("NSH", "WPG"),
    "202311260EDM": ("EDM", "ANA"),
    "202311270CBJ": ("CBJ", "BOS"),
    "202311270NYR": ("NYR", "BUF"),
    "202311270OTT": ("OTT", "FLA"),
    "202311270COL": ("COL", "TBL"),
    "202311270CGY": ("CGY", "VEG"),
    "202311270SJS": ("SJS", "WSH"),
    "202311280NJD": ("NJD", "NYI"),
    "202311280PHI": ("PHI", "CAR"),
    "202311280TOR": ("TOR", "FLA"),
    "202311280MIN": ("MIN", "STL"),
    "202311280NSH": ("NSH", "PIT"),
    "202311280WPG": ("WPG", "DAL"),
    "202311280CHI": ("CHI", "SEA"),
    "202311280ARI": ("ARI", "TBL"),
    "202311280EDM": ("EDM", "VEG"),
    "202311280VAN": ("VAN", "ANA"),
    "202311290CBJ": ("CBJ", "MTL"),
    "202311290NYR": ("NYR", "DET"),
    "202311290LAK": ("LAK", "WSH"),
    "202311300BOS": ("BOS", "SJS"),
    "202311300CAR": ("CAR", "NYI"),
    "202311300DET": ("DET", "CHI"),
    "202311300MTL": ("MTL", "FLA"),
    "202311300PHI": ("PHI", "NJD"),
    "202311300TBL": ("TBL", "PIT"),
    "202311300TOR": ("TOR", "SEA"),
    "202311300NSH": ("NSH", "MIN"),
    "202311300STL": ("STL", "BUF"),
    "202311300WPG": ("WPG", "EDM"),
    "202311300ARI": ("ARI", "COL"),
    "202311300CGY": ("CGY", "DAL"),
    "202311300ANA": ("ANA", "WSH"),
    "202311300VAN": ("VAN", "VEG"),
    "202312010CBJ": ("CBJ", "OTT"),
    "202312010NJD": ("NJD", "SJS"),
    "202312020DAL": ("DAL", "TBL"),
    "202312020WPG": ("WPG", "CHI"),
    "202312020NSH": ("NSH", "NYR"),
    "202312020FLA": ("FLA", "NYI"),
    "202312020CAR": ("CAR", "BUF"),
    "202312020MTL": ("MTL", "DET"),
    "202312020OTT": ("OTT", "SEA"),
    "202312020PIT": ("PIT", "PHI"),
    "202312020TOR": ("TOR", "BOS"),
    "202312020ARI": ("ARI", "STL"),
    "202312020ANA": ("ANA", "COL"),
    "202312020CGY": ("CGY", "VAN"),
    "202312020VEG": ("VEG", "WSH"),
    "202312030MIN": ("MIN", "CHI"),
    "202312030NYR": ("NYR", "SJS"),
    "202312030BOS": ("BOS", "CBJ"),
    "202312030BUF": ("BUF", "NSH"),
    "202312030LAK": ("LAK", "COL"),
    "202312040PHI": ("PHI", "PIT"),
    "202312040TBL": ("TBL", "DAL"),
    "202312040MTL": ("MTL", "SEA"),
    "202312040WPG": ("WPG", "CAR"),
    "202312040ARI": ("ARI", "WSH"),
    "202312040VEG": ("VEG", "STL"),
    "202312050BUF": ("BUF", "DET"),
    "202312050CBJ": ("CBJ", "LAK"),
    "202312050OTT": ("OTT", "NYR"),
    "202312050NYI": ("NYI", "SJS"),
    "202312050CHI": ("CHI", "NSH"),
    "202312050CGY": ("CGY", "MIN"),
    "202312050COL": ("COL", "ANA"),
    "202312050VAN": ("VAN", "NJD"),
    "202312060FLA": ("FLA", "DAL"),
    "202312060TBL": ("TBL", "PIT"),
    "202312060STL": ("STL", "VEG"),
    "202312060EDM": ("EDM", "CAR"),
    "202312070BOS": ("BOS", "BUF"),
    "202312070DET": ("DET", "SJS"),
    "202312070MTL": ("MTL", "LAK"),
    "202312070OTT": ("OTT", "TOR"),
    "202312070WSH": ("WSH", "DAL"),
    "202312070NYI": ("NYI", "CBJ"),
    "202312070NSH": ("NSH", "TBL"),
    "202312070CHI": ("CHI", "ANA"),
    "202312070ARI": ("ARI", "PHI"),
    "202312070CGY": ("CGY", "CAR"),
    "202312070COL": ("COL", "WPG"),
    "202312070SEA": ("SEA", "NJD"),
    "202312070VAN": ("VAN", "MIN"),
    "202312080CBJ": ("CBJ", "STL"),
    "202312080FLA": ("FLA", "PIT"),
    "202312080EDM": ("EDM", "MIN"),
    "202312090BOS": ("BOS", "ARI"),
    "202312090CGY": ("CGY", "NJD"),
    "202312090DAL": ("DAL", "VEG"),
    "202312090BUF": ("BUF", "MTL"),
    "202312090DET": ("DET", "OTT"),
    "202312090TOR": ("TOR", "NSH"),
    "202312090WSH": ("WSH", "NYR"),
    "202312090NYI": ("NYI", "LAK"),
    "202312090CHI": ("CHI", "STL"),
    "202312090COL": ("COL", "PHI"),
    "202312090SEA": ("SEA", "TBL"),
    "202312090VAN": ("VAN", "CAR"),
    "202312100CBJ": ("CBJ", "FLA"),
    "202312100EDM": ("EDM", "NJD"),
    "202312100CHI": ("CHI", "WSH"),
    "202312100MTL": ("MTL", "NSH"),
    "202312100NYR": ("NYR", "LAK"),
    "202312100ANA": ("ANA", "WPG"),
    "202312100SEA": ("SEA", "MIN"),
    "202312100VEG": ("VEG", "SJS"),
    "202312110BUF": ("BUF", "ARI"),
    "202312110NYI": ("NYI", "TOR"),
    "202312110DAL": ("DAL", "DET"),
    "202312110COL": ("COL", "CGY"),
    "202312120NYR": ("NYR", "TOR"),
    "202312120OTT": ("OTT", "CAR"),
    "202312120PIT": ("PIT", "ARI"),
    "202312120NSH": ("NSH", "PHI"),
    "202312120STL": ("STL", "DET"),
    "202312120EDM": ("EDM", "CHI"),
    "202312120SEA": ("SEA", "FLA"),
    "202312120VAN": ("VAN", "TBL"),
    "202312120VEG": ("VEG", "CGY"),
    "202312120SJS": ("SJS", "WPG"),
    "202312130MTL": ("MTL", "PIT"),
    "202312130NJD": ("NJD", "BOS"),
    "202312130NYI": ("NYI", "ANA"),
    "202312130COL": ("COL", "BUF"),
    "202312130LAK": ("LAK", "WPG"),
    "202312140DET": ("DET", "CAR"),
    "202312140PHI": ("PHI", "WSH"),
    "202312140TOR": ("TOR", "CBJ"),
    "202312140MIN": ("MIN", "CGY"),
    "202312140STL": ("STL", "OTT"),
    "202312140EDM": ("EDM", "TBL"),
    "202312140SEA": ("SEA", "CHI"),
    "202312140VAN": ("VAN", "FLA"),
    "202312150CAR": ("CAR", "NSH"),
    "202312150NYR": ("NYR", "ANA"),
    "202312150NYI": ("NYI", "BOS"),
    "202312150DAL": ("DAL", "OTT"),
    "202312150ARI": ("ARI", "SJS"),
    "202312150VEG": ("VEG", "BUF"),
    "202312160MIN": ("MIN", "VAN"),
    "202312160BOS": ("BOS", "NYR"),
    "202312160CBJ": ("CBJ", "NJD"),
    "202312160MTL": ("MTL", "NYI"),
    "202312160PHI": ("PHI", "DET"),
    "202312160TOR": ("TOR", "PIT"),
    "202312160WPG": ("WPG", "COL"),
    "202312160NSH": ("NSH", "WSH"),
    "202312160STL": ("STL", "DAL"),
    "202312160ARI": ("ARI", "BUF"),
    "202312160CGY": ("CGY", "TBL"),
    "202312160EDM": ("EDM", "FLA"),
    "202312160SEA": ("SEA", "LAK"),
    "202312170CHI": ("CHI", "VAN"),
    "202312170CAR": ("CAR", "WSH"),
    "202312170NJD": ("NJD", "ANA"),
    "202312170COL": ("COL", "SJS"),
    "202312170VEG": ("VEG", "OTT"),
    "202312180DET": ("DET", "ANA"),
    "202312180PIT": ("PIT", "MIN"),
    "202312180WPG": ("WPG", "MTL"),
    "202312180DAL": ("DAL", "SEA"),
    "202312180CGY": ("CGY", "FLA"),
    "202312190BOS": ("BOS", "MIN"),
    "202312190BUF": ("BUF", "CBJ"),
    "202312190CAR": ("CAR", "VEG"),
    "202312190NJD": ("NJD", "PHI"),
    "202312190TBL": ("TBL", "STL"),
    "202312190TOR": ("TOR", "NYR"),
    "202312190NYI": ("NYI", "EDM"),
    "202312190NSH": ("NSH", "VAN"),
    "202312190CHI": ("CHI", "COL"),
    "202312190ARI": ("ARI", "OTT"),
    "202312190SJS": ("SJS", "LAK"),
    "202312200WPG": ("WPG", "DET"),
    "202312200WSH": ("WSH", "NYI"),
    "202312200LAK": ("LAK", "SEA"),
    "202312210BUF": ("BUF", "TOR"),
    "202312210CBJ": ("CBJ", "WSH"),
    "202312210FLA": ("FLA", "STL"),
    "202312210NJD": ("NJD", "EDM"),
    "202312210PHI": ("PHI", "NSH"),
    "202312210PIT": ("PIT", "CAR"),
    "202312210TBL": ("TBL", "VEG"),
    "202312210DAL": ("DAL", "VAN"),
    "202312210MIN": ("MIN", "MTL"),
    "202312210COL": ("COL", "OTT"),
    "202312210ANA": ("ANA", "CGY"),
    "202312210SJS": ("SJS", "ARI"),
    "202312220DET": ("DET", "PHI"),
    "202312220NYR": ("NYR", "EDM"),
    "202312220WPG": ("WPG", "BOS"),
    "202312220CHI": ("CHI", "MTL"),
    "202312230FLA": ("FLA", "VEG"),
    "202312230NSH": ("NSH", "DAL"),
    "202312230CAR": ("CAR", "NYI"),
    "202312230CBJ": ("CBJ", "TOR"),
    "202312230MIN": ("MIN", "BOS"),
    "202312230NJD": ("NJD", "DET"),
    "202312230OTT": ("OTT", "PIT"),
    "202312230WSH": ("WSH", "TBL"),
    "202312230NYR": ("NYR", "BUF"),
    "202312230ANA": ("ANA", "SEA"),
    "202312230STL": ("STL", "CHI"),
    "202312230COL": ("COL", "ARI"),
    "202312230LAK": ("LAK", "CGY"),
    "202312230VAN": ("VAN", "SJS"),
    "202312270NJD": ("NJD", "CBJ"),
    "202312270NYR": ("NYR", "WSH"),
    "202312270TBL": ("TBL", "FLA"),
    "202312270TOR": ("TOR", "OTT"),
    "202312270BUF": ("BUF", "BOS"),
    "202312270NYI": ("NYI", "PIT"),
    "202312270MIN": ("MIN", "DET"),
    "202312270NSH": ("NSH", "CAR"),
    "202312270STL": ("STL", "DAL"),
    "202312270ARI": ("ARI", "COL"),
    "202312270CHI": ("CHI", "WPG"),
    "202312270CGY": ("CGY", "SEA"),
    "202312270ANA": ("ANA", "VEG"),
    "202312270LAK": ("LAK", "SJS"),
    "202312280CAR": ("CAR", "MTL"),
    "202312280VAN": ("VAN", "PHI"),
    "202312280VEG": ("VEG", "LAK"),
    "202312280SJS": ("SJS", "EDM"),
    "202312290CBJ": ("CBJ", "TOR"),
    "202312290DET": ("DET", "NSH"),
    "202312290FLA": ("FLA", "NYR"),
    "202312290OTT": ("OTT", "NJD"),
    "202312290NYI": ("NYI", "WSH"),
    "202312290DAL": ("DAL", "CHI"),
    "202312290STL": ("STL", "COL"),
    "202312290ANA": ("ANA", "ARI"),
    "202312290SEA": ("SEA", "PHI"),
    "202312300WPG": ("WPG", "MIN"),
    "202312300BUF": ("BUF", "CBJ"),
    "202312300BOS": ("BOS", "NJD"),
    "202312300FLA": ("FLA", "MTL"),
    "202312300PIT": ("PIT", "STL"),
    "202312300TBL": ("TBL", "NYR"),
    "202312300TOR": ("TOR", "CAR"),
    "202312300WSH": ("WSH", "NSH"),
    "202312300LAK": ("LAK", "EDM"),
    "202312310MIN": ("MIN", "WPG"),
    "202312310DET": ("DET", "BOS"),
    "202312310OTT": ("OTT", "BUF"),
    "202312310PIT": ("PIT", "NYI"),
    "202312310TBL": ("TBL", "MTL"),
    "202312310ANA": ("ANA", "EDM"),
    "202312310CGY": ("CGY", "PHI"),
    "202312310COL": ("COL", "SJS"),
    "202312310DAL": ("DAL", "CHI"),
    "202401010SEA": ("SEA", "VEG"),
    "202401020CBJ": ("CBJ", "BOS"),
    "202401020NYR": ("NYR", "CAR"),
    "202401020PIT": ("PIT", "WSH"),
    "202401020DAL": ("DAL", "MTL"),
    "202401020MIN": ("MIN", "CGY"),
    "202401020NSH": ("NSH", "CHI"),
    "202401020WPG": ("WPG", "TBL"),
    "202401020ARI": ("ARI", "FLA"),
    "202401020COL": ("COL", "NYI"),
    "202401020EDM": ("EDM", "PHI"),
    "202401020VAN": ("VAN", "OTT"),
    "202401020LAK": ("LAK", "TOR"),
    "202401020SJS": ("SJS", "DET"),
    "202401030WSH": ("WSH", "NJD"),
    "202401030ANA": ("ANA", "TOR"),
    "202401040BOS": ("BOS", "PIT"),
    "202401040MTL": ("MTL", "BUF"),
    "202401040NYR": ("NYR", "CHI"),
    "202401040PHI": ("PHI", "CBJ"),
    "202401040DAL": ("DAL", "COL"),
    "202401040MIN": ("MIN", "TBL"),
    "202401040NSH": ("NSH", "CGY"),
    "202401040STL": ("STL", "VAN"),
    "202401040ARI": ("ARI", "NYI"),
    "202401040SEA": ("SEA", "OTT"),
    "202401040VEG": ("VEG", "FLA"),
    "202401040LAK": ("LAK", "DET"),
    "202401040SJS": ("SJS", "WPG"),
    "202401050NJD": ("NJD", "CHI"),
    "202401050WSH": ("WSH", "CAR"),
    "202401050ANA": ("ANA", "WPG"),
    "202401060PHI": ("PHI", "CGY"),
    "202401060COL": ("COL", "FLA"),
    "202401060BOS": ("BOS", "TBL"),
    "202401060CAR": ("CAR", "STL"),
    "202401060CBJ": ("CBJ", "MIN"),
    "202401060MTL": ("MTL", "NYR"),
    "202401060NJD": ("NJD", "VAN"),
    "202401060PIT": ("PIT", "BUF"),
    "202401060SJS": ("SJS", "TOR"),
    "202401060DAL": ("DAL", "NSH"),
    "202401060EDM": ("EDM", "OTT"),
    "202401060VEG": ("VEG", "NYI"),
    "202401070CHI": ("CHI", "CGY"),
    "202401070WSH": ("WSH", "LAK"),
    "202401070ARI": ("ARI", "WPG"),
    "202401070ANA": ("ANA", "DET"),
    "202401080NYR": ("NYR", "VAN"),
    "202401080PHI": ("PHI", "PIT"),
    "202401080MIN": ("MIN", "DAL"),
    "202401080COL": ("COL", "BOS"),
    "202401090BUF": ("BUF", "SEA"),
    "202401090TBL": ("TBL", "LAK"),
    "202401090TOR": ("TOR", "SJS"),
    "202401090NYI": ("NYI", "VAN"),
    "202401090NSH": ("NSH", "ANA"),
    "202401090STL": ("STL", "FLA"),
    "202401090WPG": ("WPG", "CBJ"),
    "202401090CHI": ("CHI", "EDM"),
    "202401090ARI": ("ARI", "BOS"),
    "202401090CGY": ("CGY", "OTT"),
    "202401100PHI": ("PHI", "MTL"),
    "202401100DAL": ("DAL", "MIN"),
    "202401100COL": ("COL", "VEG"),
    "202401110BUF": ("BUF", "OTT"),
    "202401110CAR": ("CAR", "ANA"),
    "202401110DET": ("DET", "EDM"),
    "202401110FLA": ("FLA", "LAK"),
    "202401110MTL": ("MTL", "SJS"),
    "202401110PIT": ("PIT", "VAN"),
    "202401110TBL": ("TBL", "NJD"),
    "202401110WSH": ("WSH", "SEA"),
    "202401110NYI": ("NYI", "TOR"),
    "202401110STL": ("STL", "NYR"),
    "202401110WPG": ("WPG", "CHI"),
    "202401110ARI": ("ARI", "CGY"),
    "202401110VEG": ("VEG", "BOS"),
    "202401120DAL": ("DAL", "NSH"),
    "202401120MIN": ("MIN", "PHI"),
    "202401130WSH": ("WSH", "NYR"),
    "202401130BUF": ("BUF", "VAN"),
    "202401130OTT": ("OTT", "SJS"),
    "202401130FLA": ("FLA", "NJD"),
    "202401130CAR": ("CAR", "PIT"),
    "202401130CBJ": ("CBJ", "SEA"),
    "202401130DET": ("DET", "LAK"),
    "202401130MTL": ("MTL", "EDM"),
    "202401130TBL": ("TBL", "ANA"),
    "202401130TOR": ("TOR", "COL"),
    "202401130WPG": ("WPG", "PHI"),
    "202401130CHI": ("CHI", "DAL"),
    "202401130MIN": ("MIN", "ARI"),
    "202401130NSH": ("NSH", "NYI"),
    "202401130STL": ("STL", "BOS"),
    "202401130VEG": ("VEG", "CGY"),
    "202401140NYR": ("NYR", "WSH"),
    "202401140TOR": ("TOR", "DET"),
    "202401150BOS": ("BOS", "NJD"),
    "202401150BUF": ("BUF", "SJS"),
    "202401150CBJ": ("CBJ", "VAN"),
    "202401150FLA": ("FLA", "ANA"),
    "202401150CAR": ("CAR", "LAK"),
    "202401150MIN": ("MIN", "NYI"),
    "202401150PIT": ("PIT", "SEA"),
    "202401150MTL": ("MTL", "COL"),
    "202401150STL": ("STL", "PHI"),
    "202401150VEG": ("VEG", "NSH"),
    "202401160NYR": ("NYR", "SEA"),
    "202401160OTT": ("OTT", "COL"),
    "202401160WSH": ("WSH", "ANA"),
    "202401160DAL": ("DAL", "LAK"),
    "202401160WPG": ("WPG", "NYI"),
    "202401160CHI": ("CHI", "SJS"),
    "202401160CGY": ("CGY", "ARI"),
    "202401160EDM": ("EDM", "TOR"),
    "202401170FLA": ("FLA", "DET"),
    "202401170NJD": ("NJD", "MTL"),
    "202401180BUF": ("BUF", "CHI"),
    "202401180BOS": ("BOS", "COL"),
    "202401180OTT": ("OTT", "MTL"),
    "202401180PHI": ("PHI", "DAL"),
    "202401180TBL": ("TBL", "MIN"),
    "202401180WSH": ("WSH", "STL"),
    "202401180CGY": ("CGY", "TOR"),
    "202401180EDM": ("EDM", "SEA"),
    "202401180LAK": ("LAK", "NSH"),
    "202401180VAN": ("VAN", "ARI"),
    "202401180VEG": ("VEG", "NYR"),
    "202401190CAR": ("CAR", "DET"),
    "202401190CBJ": ("CBJ", "NJD"),
    "202401190FLA": ("FLA", "MIN"),
    "202401190CHI": ("CHI", "NYI"),
    "202401200BUF": ("BUF", "TBL"),
    "202401200PHI": ("PHI", "COL"),
    "202401200ARI": ("ARI", "NSH"),
    "202401200OTT": ("OTT", "WPG"),
    "202401200BOS": ("BOS", "MTL"),
    "202401200NJD": ("NJD", "DAL"),
    "202401200VAN": ("VAN", "TOR"),
    "202401200STL": ("STL", "WSH"),
    "202401200CGY": ("CGY", "EDM"),
    "202401200SJS": ("SJS", "ANA"),
    "202401200VEG": ("VEG", "PIT"),
    "202401200LAK": ("LAK", "NYR"),
    "202401210PHI": ("PHI", "OTT"),
    "202401210CAR": ("CAR", "MIN"),
    "202401210DET": ("DET", "TBL"),
    "202401210NYI": ("NYI", "DAL"),
    "202401210ANA": ("ANA", "NYR"),
    "202401210SEA": ("SEA", "TOR"),
    "202401220BOS": ("BOS", "WPG"),
    "202401220NJD": ("NJD", "VEG"),
    "202401220NSH": ("NSH", "FLA"),
    "202401220ARI": ("ARI", "PIT"),
    "202401220VAN": ("VAN", "CHI"),
    "202401220LAK": ("LAK", "SJS"),
    "202401230DET": ("DET", "DAL"),
    "202401230MTL": ("MTL", "OTT"),
    "202401230PHI": ("PHI", "TBL"),
    "202401230NYI": ("NYI", "VEG"),
    "202401230MIN": ("MIN", "WSH"),
    "202401230CGY": ("CGY", "STL"),
    "202401230EDM": ("EDM", "CBJ"),
    "202401230ANA": ("ANA", "BUF"),
    "202401230SJS": ("SJS", "NYR"),
    "202401240FLA": ("FLA", "ARI"),
    "202401240TOR": ("TOR", "WPG"),
    "202401240BOS": ("BOS", "CAR"),
    "202401240COL": ("COL", "WSH"),
    "202401240SEA": ("SEA", "CHI"),
    "202401240VAN": ("VAN", "STL"),
    "202401240LAK": ("LAK", "BUF"),
    "202401250CAR": ("CAR", "NJD"),
    "202401250DET": ("DET", "PHI"),
    "202401250MTL": ("MTL", "NYI"),
    "202401250OTT": ("OTT", "BOS"),
    "202401250TBL": ("TBL", "ARI"),
    "202401250DAL": ("DAL", "ANA"),
    "202401250MIN": ("MIN", "NSH"),
    "202401250CGY": ("CGY", "CBJ"),
    "202401250EDM": ("EDM", "CHI"),
    "202401260NYR": ("NYR", "VEG"),
    "202401260PIT": ("PIT", "FLA"),
    "202401260COL": ("COL", "LAK"),
    "202401260SEA": ("SEA", "STL"),
    "202401270PHI": ("PHI", "BOS"),
    "202401270DAL": ("DAL", "WSH"),
    "202401270EDM": ("EDM", "NSH"),
    "202401270SJS": ("SJS", "BUF"),
    "202401270CAR": ("CAR", "ARI"),
    "202401270DET": ("DET", "VEG"),
    "202401270OTT": ("OTT", "NYR"),
    "202401270PIT": ("PIT", "MTL"),
    "202401270TBL": ("TBL", "NJD"),
    "202401270WPG": ("WPG", "TOR"),
    "202401270NYI": ("NYI", "FLA"),
    "202401270MIN": ("MIN", "ANA"),
    "202401270CGY": ("CGY", "CHI"),
    "202401270VAN": ("VAN", "CBJ"),
    "202401280STL": ("STL", "LAK"),
    "202401280SEA": ("SEA", "CBJ"),
    "202401290OTT": ("OTT", "NSH"),
    "202401300STL": ("STL", "CBJ"),
    "202401300SJS": ("SJS", "SEA"),
    "202401310DET": ("DET", "OTT"),
    "202401310NSH": ("NSH", "LAK"),
    "202401310ANA": ("ANA", "SJS"),
    "202402050NYR": ("NYR", "COL"),
    "202402050TOR": ("TOR", "NYI"),
    "202402060BOS": ("BOS", "CGY"),
    "202402060BUF": ("BUF", "DAL"),
    "202402060CAR": ("CAR", "VAN"),
    "202402060FLA": ("FLA", "PHI"),
    "202402060NJD": ("NJD", "COL"),
    "202402060PIT": ("PIT", "WPG"),
    "202402060WSH": ("WSH", "MTL"),
    "202402060VEG": ("VEG", "EDM"),
    "202402070NYR": ("NYR", "TBL"),
    "202402070TOR": ("TOR", "DAL"),
    "202402070CHI": ("CHI", "MIN"),
    "202402080BOS": ("BOS", "VAN"),
    "202402080FLA": ("FLA", "WSH"),
    "202402080NJD": ("NJD", "CGY"),
    "202402080PHI": ("PHI", "WPG"),
    "202402080NYI": ("NYI", "TBL"),
    "202402080CAR": ("CAR", "COL"),
    "202402080ARI": ("ARI", "VEG"),
    "202402090MIN": ("MIN", "PIT"),
    "202402090CHI": ("CHI", "NYR"),
    "202402090ANA": ("ANA", "EDM"),
    "202402100BUF": ("BUF", "STL"),
    "202402100DET": ("DET", "VAN"),
    "202402100MTL": ("MTL", "DAL"),
    "202402100NYI": ("NYI", "CGY"),
    "202402100BOS": ("BOS", "WSH"),
    "202402100FLA": ("FLA", "COL"),
    "202402100CAR": ("CAR", "NJD"),
    "202402100CBJ": ("CBJ", "TBL"),
    "202402100OTT": ("OTT", "TOR"),
    "202402100PHI": ("PHI", "SEA"),
    "202402100WPG": ("WPG", "PIT"),
    "202402100NSH": ("NSH", "ARI"),
    "202402100LAK": ("LAK", "EDM"),
    "202402110MTL": ("MTL", "STL"),
    "202402110WSH": ("WSH", "VAN"),
    "202402120NJD": ("NJD", "SEA"),
    "202402120NYR": ("NYR", "CGY"),
    "202402120PHI": ("PHI", "ARI"),
    "202402120VEG": ("VEG", "MIN"),
    "202402130BOS": ("BOS", "TBL"),
    "202402130BUF": ("BUF", "LAK"),
    "202402130MTL": ("MTL", "ANA"),
    "202402130OTT": ("OTT", "CBJ"),
    "202402130TOR": ("TOR", "STL"),
    "202402130WSH": ("WSH", "COL"),
    "202402130NYI": ("NYI", "SEA"),
    "202402130DAL": ("DAL", "CAR"),
    "202402130NSH": ("NSH", "NJD"),
    "202402130CHI": ("CHI", "VAN"),
    "202402130EDM": ("EDM", "DET"),
    "202402140PIT": ("PIT", "FLA"),
    "202402140WPG": ("WPG", "SJS"),
    "202402140ARI": ("ARI", "MIN"),
    "202402150BOS": ("BOS", "SEA"),
    "202402150BUF": ("BUF", "FLA"),
    "202402150NJD": ("NJD", "LAK"),
    "202402150NYR": ("NYR", "MTL"),
    "202402150OTT": ("OTT", "ANA"),
    "202402150TBL": ("TBL", "COL"),
    "202402150TOR": ("TOR", "PHI"),
    "202402150STL": ("STL", "EDM"),
    "202402150CHI": ("CHI", "PIT"),
    "202402150CGY": ("CGY", "SJS"),
    "202402150NSH": ("NSH", "DAL"),
    "202402150VAN": ("VAN", "DET"),
    "202402160ARI": ("ARI", "CAR"),
    "202402170DAL": ("DAL", "EDM"),
    "202402170CHI": ("CHI", "OTT"),
    "202402170CGY": ("CGY", "DET"),
    "202402170BOS": ("BOS", "LAK"),
    "202402170MIN": ("MIN", "BUF"),
    "202402170STL": ("STL", "NSH"),
    "202402170TBL": ("TBL", "FLA"),
    "202402170MTL": ("MTL", "WSH"),
    "202402170TOR": ("TOR", "ANA"),
    "202402170NJD": ("NJD", "PHI"),
    "202402170VAN": ("VAN", "WPG"),
    "202402170SJS": ("SJS", "CBJ"),
    "202402170VEG": ("VEG", "CAR"),
    "202402180NYI": ("NYI", "NYR"),
    "202402180COL": ("COL", "ARI"),
    "202402180PIT": ("PIT", "LAK"),
    "202402190BUF": ("BUF", "ANA"),
    "202402190BOS": ("BOS", "DAL"),
    "202402190STL": ("STL", "TOR"),
    "202402190MIN": ("MIN", "VAN"),
    "202402190SEA": ("SEA", "DET"),
    "202402190ARI": ("ARI", "EDM"),
    "202402190CGY": ("CGY", "WPG"),
    "202402190SJS": ("SJS", "VEG"),
    "202402190CAR": ("CAR", "CHI"),
    "202402190TBL": ("TBL", "OTT"),
    "202402200FLA": ("FLA", "OTT"),
    "202402200NYR": ("NYR", "DAL"),
    "202402200PIT": ("PIT", "NYI"),
    "202402200WSH": ("WSH", "NJD"),
    "202402200WPG": ("WPG", "MIN"),
    "202402200COL": ("COL", "VAN"),
    "202402200VEG": ("VEG", "NSH"),
    "202402200LAK": ("LAK", "CBJ"),
    "202402210MTL": ("MTL", "BUF"),
    "202402210CHI": ("CHI", "PHI"),
    "202402210ANA": ("ANA", "CBJ"),
    "202402210ARI": ("ARI", "TOR"),
    "202402210EDM": ("EDM", "BOS"),
    "202402220CAR": ("CAR", "FLA"),
    "202402220DET": ("DET", "COL"),
    "202402220NJD": ("NJD", "NYR"),
    "202402220OTT": ("OTT", "DAL"),
    "202402220PIT": ("PIT", "MTL"),
    "202402220TBL": ("TBL", "WSH"),
    "202402220STL": ("STL", "NYI"),
    "202402220CGY": ("CGY", "BOS"),
    "202402220SEA": ("SEA", "VAN"),
    "202402220VEG": ("VEG", "TOR"),
    "202402220LAK": ("LAK", "NSH"),
    "202402230CBJ": ("CBJ", "BUF"),
    "202402230CHI": ("CHI", "WPG"),
    "202402230EDM": ("EDM", "MIN"),
    "202402240NJD": ("NJD", "MTL"),
    "202402240NYI": ("NYI", "TBL"),
    "202402240PHI": ("PHI", "NYR"),
    "202402240FLA": ("FLA", "WSH"),
    "202402240CAR": ("CAR", "DAL"),
    "202402240COL": ("COL", "TOR"),
    "202402240DET": ("DET", "STL"),
    "202402240OTT": ("OTT", "VEG"),
    "202402240VAN": ("VAN", "BOS"),
    "202402240EDM": ("EDM", "CGY"),
    "202402240SEA": ("SEA", "MIN"),
    "202402240SJS": ("SJS", "NSH"),
    "202402240LAK": ("LAK", "ANA"),
    "202402250NJD": ("NJD", "TBL"),
    "202402250PIT": ("PIT", "PHI"),
    "202402250BUF": ("BUF", "CAR"),
    "202402250CBJ": ("CBJ", "NYR"),
    "202402250CHI": ("CHI", "DET"),
    "202402250WPG": ("WPG", "ARI"),
    "202402250ANA": ("ANA", "NSH"),
    "202402260WSH": ("WSH", "OTT"),
    "202402260DAL": ("DAL", "NYI"),
    "202402260EDM": ("EDM", "LAK"),
    "202402260SEA": ("SEA", "BOS"),
    "202402270DET": ("DET", "WSH"),
    "202402270FLA": ("FLA", "BUF"),
    "202402270MTL": ("MTL", "ARI"),
    "202402270PHI": ("PHI", "TBL"),
    "202402270TOR": ("TOR", "VEG"),
    "202402270MIN": ("MIN", "CAR"),
    "202402270NSH": ("NSH", "OTT"),
    "202402270WPG": ("WPG", "STL"),
    "202402270CGY": ("CGY", "LAK"),
    "202402270COL": ("COL", "DAL"),
    "202402270VAN": ("VAN", "PIT"),
    "202402270SJS": ("SJS", "NJD"),
    "202402280NYR": ("NYR", "CBJ"),
    "202402280EDM": ("EDM", "STL"),
    "202402290BOS": ("BOS", "VEG"),
    "202402290CBJ": ("CBJ", "CAR"),
    "202402290DET": ("DET", "NYI"),
    "202402290FLA": ("FLA", "MTL"),
    "202402290TBL": ("TBL", "BUF"),
    "202402290TOR": ("TOR", "ARI"),
    "202402290DAL": ("DAL", "WPG"),
    "202402290NSH": ("NSH", "MIN"),
    "202402290CHI": ("CHI", "COL"),
    "202402290SEA": ("SEA", "PIT"),
    "202402290VAN": ("VAN", "LAK"),
    "202402290SJS": ("SJS", "ANA"),
    "202403010OTT": ("OTT", "ARI"),
    "202403010WSH": ("WSH", "PHI"),
    "202403010ANA": ("ANA", "NJD"),
    "202403020CAR": ("CAR", "WPG"),
    "202403020NYI": ("NYI", "BOS"),
    "202403020SEA": ("SEA", "EDM"),
    "202403020NSH": ("NSH", "COL"),
    "202403020BUF": ("BUF", "VEG"),
    "202403020DET": ("DET", "FLA"),
    "202403020PHI": ("PHI", "OTT"),
    "202403020TBL": ("TBL", "MTL"),
    "202403020TOR": ("TOR", "NYR"),
    "202403020CHI": ("CHI", "CBJ"),
    "202403020DAL": ("DAL", "SJS"),
    "202403020STL": ("STL", "MIN"),
    "202403020CGY": ("CGY", "PIT"),
    "202403030WSH": ("WSH", "ARI"),
    "202403030LAK": ("LAK", "NJD"),
    "202403030BUF": ("BUF", "WPG"),
    "202403030MIN": ("MIN", "SJS"),
    "202403030ANA": ("ANA", "VAN"),
    "202403030EDM": ("EDM", "PIT"),
    "202403040CBJ": ("CBJ", "VEG"),
    "202403040NYR": ("NYR", "FLA"),
    "202403040PHI": ("PHI", "STL"),
    "202403040TOR": ("TOR", "BOS"),
    "202403040COL": ("COL", "CHI"),
    "202403040CGY": ("CGY", "SEA"),
    "202403050BOS": ("BOS", "EDM"),
    "202403050NJD": ("NJD", "FLA"),
    "202403050PIT": ("PIT", "CBJ"),
    "202403050NYI": ("NYI", "STL"),
    "202403050NSH": ("NSH", "MTL"),
    "202403050WPG": ("WPG", "SEA"),
    "202403050ARI": ("ARI", "CHI"),
    "202403050LAK": ("LAK", "VAN"),
    "202403050SJS": ("SJS", "DAL"),
    "202403060TOR": ("TOR", "BUF"),
    "202403060COL": ("COL", "DET"),
    "202403060ANA": ("ANA", "OTT"),
    "202403070BOS": ("BOS", "TOR"),
    "202403070CAR": ("CAR", "MTL"),
    "202403070CBJ": ("CBJ", "EDM"),
    "202403070FLA": ("FLA", "PHI"),
    "202403070NJD": ("NJD", "STL"),
    "202403070PIT": ("PIT", "WSH"),
    "202403070TBL": ("TBL", "CGY"),
    "202403070NSH": ("NSH", "BUF"),
    "202403070ARI": ("ARI", "MIN"),
    "202403070VEG": ("VEG", "VAN"),
    "202403070LAK": ("LAK", "OTT"),
    "202403070SJS": ("SJS", "NYI"),
    "202403080ARI": ("ARI", "DET"),
    "202403080COL": ("COL", "MIN"),
    "202403080ANA": ("ANA", "DAL"),
    "202403080SEA": ("SEA", "WPG"),
    "202403090BUF": ("BUF", "EDM"),
    "202403090CBJ": ("CBJ", "NSH"),
    "202403090NJD": ("NJD", "CAR"),
    "202403090BOS": ("BOS", "PIT"),
    "202403090FLA": ("FLA", "CGY"),
    "202403090MTL": ("MTL", "TOR"),
    "202403090SJS": ("SJS", "OTT"),
    "202403090TBL": ("TBL", "PHI"),
    "202403090WSH": ("WSH", "CHI"),
    "202403090NYR": ("NYR", "STL"),
    "202403090VAN": ("VAN", "WPG"),
    "202403090VEG": ("VEG", "DET"),
    "202403090LAK": ("LAK", "DAL"),
    "202403100PIT": ("PIT", "EDM"),
    "202403100MIN": ("MIN", "NSH"),
    "202403100CAR": ("CAR", "CGY"),
    "202403100CHI": ("CHI", "ARI"),
    "202403100ANA": ("ANA", "NYI"),
    "202403110BOS": ("BOS", "STL"),
    "202403110NYR": ("NYR", "NJD"),
    "202403110WPG": ("WPG", "WSH"),
    "202403110LAK": ("LAK", "NYI"),
    "202403120BUF": ("BUF", "DET"),
    "202403120CAR": ("CAR", "NYR"),
    "202403120MTL": ("MTL", "CBJ"),
    "202403120OTT": ("OTT", "PIT"),
    "202403120PHI": ("PHI", "SJS"),
    "202403120DAL": ("DAL", "FLA"),
    "202403120MIN": ("MIN", "ARI"),
    "202403120CHI": ("CHI", "ANA"),
    "202403120CGY": ("CGY", "COL"),
    "202403120SEA": ("SEA", "VEG"),
    "202403130STL": ("STL", "LAK"),
    "202403130WPG": ("WPG", "NSH"),
    "202403130EDM": ("EDM", "WSH"),
    "202403130VAN": ("VAN", "COL"),
    "202403140BUF": ("BUF", "NYI"),
    "202403140CAR": ("CAR", "FLA"),
    "202403140CBJ": ("CBJ", "OTT"),
    "202403140DET": ("DET", "ARI"),
    "202403140MTL": ("MTL", "BOS"),
    "202403140PHI": ("PHI", "TOR"),
    "202403140PIT": ("PIT", "SJS"),
    "202403140TBL": ("TBL", "NYR"),
    "202403140DAL": ("DAL", "NJD"),
    "202403140MIN": ("MIN", "ANA"),
    "202403140CGY": ("CGY", "VEG"),
    "202403140SEA": ("SEA", "WSH"),
    "202403150WPG": ("WPG", "ANA"),
    "202403150CHI": ("CHI", "LAK"),
    "202403160DET": ("DET", "BUF"),
    "202403160NYI": ("NYI", "OTT"),
    "202403160PIT": ("PIT", "NYR"),
    "202403160ARI": ("ARI", "NJD"),
    "202403160FLA": ("FLA", "TBL"),
    "202403160BOS": ("BOS", "PHI"),
    "202403160CBJ": ("CBJ", "SJS"),
    "202403160CGY": ("CGY", "MTL"),
    "202403160TOR": ("TOR", "CAR"),
    "202403160DAL": ("DAL", "LAK"),
    "202403160STL": ("STL", "MIN"),
    "202403160EDM": ("EDM", "COL"),
    "202403160SEA": ("SEA", "NSH"),
    "202403160VAN": ("VAN", "WSH"),
    "202403170NYR": ("NYR", "NYI"),
    "202403170VEG": ("VEG", "NJD"),
    "202403170CBJ": ("CBJ", "WPG"),
    "202403170CHI": ("CHI", "SJS"),
    "202403170OTT": ("OTT", "CAR"),
    "202403170PIT": ("PIT", "DET"),
    "202403170STL": ("STL", "ANA"),
    "202403180CGY": ("CGY", "WSH"),
    "202403180SEA": ("SEA", "BUF"),
    "202403190BOS": ("BOS", "OTT"),
    "202403190DET": ("DET", "CBJ"),
    "202403190NJD": ("NJD", "PIT"),
    "202403190NYR": ("NYR", "WPG"),
    "202403190PHI": ("PHI", "TOR"),
    "202403190NYI": ("NYI", "CAR"),
    "202403190NSH": ("NSH", "SJS"),
    "202403190STL": ("STL", "COL"),
    "202403190EDM": ("EDM", "MTL"),
    "202403190ANA": ("ANA", "MIN"),
    "202403190LAK": ("LAK", "CHI"),
    "202403190VAN": ("VAN", "BUF"),
    "202403190VEG": ("VEG", "TBL"),
    "202403200WSH": ("WSH", "TOR"),
    "202403200DAL": ("DAL", "ARI"),
    "202403200LAK": ("LAK", "MIN"),
    "202403210BOS": ("BOS", "NYR"),
    "202403210CAR": ("CAR", "PHI"),
    "202403210DET": ("DET", "NYI"),
    "202403210FLA": ("FLA", "NSH"),
    "202403210NJD": ("NJD", "WPG"),
    "202403210OTT": ("OTT", "STL"),
    "202403210EDM": ("EDM", "BUF"),
    "202403210ANA": ("ANA", "CHI"),
    "202403210VAN": ("VAN", "MTL"),
    "202403210VEG": ("VEG", "SEA"),
    "202403210SJS": ("SJS", "TBL"),
    "202403220WSH": ("WSH", "CAR"),
    "202403220DAL": ("DAL", "PIT"),
    "202403220COL": ("COL", "CBJ"),
    "202403220ARI": ("ARI", "SEA"),
    "202403230NYI": ("NYI", "WPG"),
    "202403230PHI": ("PHI", "BOS"),
    "202403230MIN": ("MIN", "STL"),
    "202403230NSH": ("NSH", "DET"),
    "202403230NJD": ("NJD", "OTT"),
    "202403230TOR": ("TOR", "EDM"),
    "202403230NYR": ("NYR", "FLA"),
    "202403230VAN": ("VAN", "CGY"),
    "202403230LAK": ("LAK", "TBL"),
    "202403230SJS": ("SJS", "CHI"),
    "202403230VEG": ("VEG", "CBJ"),
    "202403240WSH": ("WSH", "WPG"),
    "202403240COL": ("COL", "PIT"),
    "202403240NYI": ("NYI", "NJD"),
    "202403240CAR": ("CAR", "TOR"),
    "202403240OTT": ("OTT", "EDM"),
    "202403240PHI": ("PHI", "FLA"),
    "202403240ARI": ("ARI", "DAL"),
    "202403240ANA": ("ANA", "TBL"),
    "202403240CGY": ("CGY", "BUF"),
    "202403240SEA": ("SEA", "MTL"),
    "202403250STL": ("STL", "VEG"),
    "202403250VAN": ("VAN", "LAK"),
    "202403260FLA": ("FLA", "BOS"),
    "202403260NYR": ("NYR", "PHI"),
    "202403260PIT": ("PIT", "CAR"),
    "202403260TOR": ("TOR", "NJD"),
    "202403260WSH": ("WSH", "DET"),
    "202403260NSH": ("NSH", "VEG"),
    "202403260WPG": ("WPG", "EDM"),
    "202403260CHI": ("CHI", "CGY"),
    "202403260COL": ("COL", "MTL"),
    "202403260ARI": ("ARI", "CBJ"),
    "202403260SEA": ("SEA", "ANA"),
    "202403260SJS": ("SJS", "DAL"),
    "202403270BUF": ("BUF", "OTT"),
    "202403270TBL": ("TBL", "BOS"),
    "202403280CAR": ("CAR", "DET"),
    "202403280FLA": ("FLA", "NYI"),
    "202403280MTL": ("MTL", "PHI"),
    "202403280OTT": ("OTT", "CHI"),
    "202403280PIT": ("PIT", "CBJ"),
    "202403280TOR": ("TOR", "WSH"),
    "202403280MIN": ("MIN", "SJS"),
    "202403280STL": ("STL", "CGY"),
    "202403280WPG": ("WPG", "VEG"),
    "202403280COL": ("COL", "NYR"),
    "202403280EDM": ("EDM", "LAK"),
    "202403280ARI": ("ARI", "NSH"),
    "202403280SEA": ("SEA", "ANA"),
    "202403280VAN": ("VAN", "DAL"),
    "202403290BUF": ("BUF", "NJD"),
    "202403300FLA": ("FLA", "DET"),
    "202403300MIN": ("MIN", "VEG"),
    "202403300EDM": ("EDM", "ANA"),
    "202403300ARI": ("ARI", "NYR"),
    "202403300COL": ("COL", "NSH"),
    "202403300BUF": ("BUF", "TOR"),
    "202403300CBJ": ("CBJ", "PIT"),
    "202403300MTL": ("MTL", "CAR"),
    "202403300PHI": ("PHI", "CHI"),
    "202403300TBL": ("TBL", "NYI"),
    "202403300WPG": ("WPG", "OTT"),
    "202403300WSH": ("WSH", "BOS"),
    "202403300STL": ("STL", "SJS"),
    "202403300CGY": ("CGY", "LAK"),
    "202403300SEA": ("SEA", "DAL"),
    "202403310VAN": ("VAN", "ANA"),
    "202404010CBJ": ("CBJ", "COL"),
    "202404010NYR": ("NYR", "PIT"),
    "202404010PHI": ("PHI", "NYI"),
    "202404010TBL": ("TBL", "DET"),
    "202404010TOR": ("TOR", "FLA"),
    "202404010STL": ("STL", "EDM"),
    "202404010WPG": ("WPG", "LAK"),
    "202404010SJS": ("SJS", "SEA"),
    "202404020BUF": ("BUF", "WSH"),
    "202404020MTL": ("MTL", "FLA"),
    "202404020NJD": ("NJD", "PIT"),
    "202404020NYI": ("NYI", "CHI"),
    "202404020MIN": ("MIN", "OTT"),
    "202404020NSH": ("NSH", "BOS"),
    "202404020CGY": ("CGY", "ANA"),
    "202404020VEG": ("VEG", "VAN"),
    "202404030TOR": ("TOR", "TBL"),
    "202404030NYR": ("NYR", "NJD"),
    "202404030DAL": ("DAL", "EDM"),
    "202404030ARI": ("ARI", "VAN"),
    "202404030LAK": ("LAK", "SEA"),
    "202404040CAR": ("CAR", "BOS"),
    "202404040CBJ": ("CBJ", "NYI"),
    "202404040MTL": ("MTL", "TBL"),
    "202404040OTT": ("OTT", "FLA"),
    "202404040WSH": ("WSH", "PIT"),
    "202404040MIN": ("MIN", "COL"),
    "202404040NSH": ("NSH", "STL"),
    "202404040WPG": ("WPG", "CGY"),
    "202404040SJS": ("SJS", "LAK"),
    "202404050BUF": ("BUF", "PHI"),
    "202404050CAR": ("CAR", "WSH"),
    "202404050DET": ("DET", "NYR"),
    "202404050EDM": ("EDM", "COL"),
    "202404050ANA": ("ANA", "SEA"),
    "202404050ARI": ("ARI", "VEG"),
    "202404060PIT": ("PIT", "TBL"),
    "202404060BOS": ("BOS", "FLA"),
    "202404060MIN": ("MIN", "WPG"),
    "202404060CHI": ("CHI", "DAL"),
    "202404060SJS": ("SJS", "STL"),
    "202404060CBJ": ("CBJ", "PHI"),
    "202404060MTL": ("MTL", "TOR"),
    "202404060OTT": ("OTT", "NJD"),
    "202404060NYI": ("NYI", "NSH"),
    "202404060CGY": ("CGY", "EDM"),
    "202404060LAK": ("LAK", "VAN"),
    "202404070DET": ("DET", "BUF"),
    "202404070CHI": ("CHI", "MIN"),
    "202404070CAR": ("CAR", "CBJ"),
    "202404070SJS": ("SJS", "ARI"),
    "202404070WSH": ("WSH", "OTT"),
    "202404070NJD": ("NJD", "NSH"),
    "202404070NYR": ("NYR", "MTL"),
    "202404070ANA": ("ANA", "STL"),
    "202404070COL": ("COL", "DAL"),
    "202404080TOR": ("TOR", "PIT"),
    "202404080VAN": ("VAN", "VEG"),
    "202404090BOS": ("BOS", "CAR"),
    "202404090DET": ("DET", "WSH"),
    "202404090FLA": ("FLA", "OTT"),
    "202404090MTL": ("MTL", "PHI"),
    "202404090NJD": ("NJD", "TOR"),
    "202404090NYI": ("NYI", "NYR"),
    "202404090TBL": ("TBL", "CBJ"),
    "202404090DAL": ("DAL", "BUF"),
    "202404090NSH": ("NSH", "WPG"),
    "202404090COL": ("COL", "MIN"),
    "202404090ANA": ("ANA", "LAK"),
    "202404090SEA": ("SEA", "ARI"),
    "202404090SJS": ("SJS", "CGY"),
    "202404100STL": ("STL", "CHI"),
    "202404100EDM": ("EDM", "VEG"),
    "202404100VAN": ("VAN", "ARI"),
    "202404110BUF": ("BUF", "WSH"),
    "202404110FLA": ("FLA", "CBJ"),
    "202404110NYR": ("NYR", "PHI"),
    "202404110PIT": ("PIT", "DET"),
    "202404110TBL": ("TBL", "OTT"),
    "202404110TOR": ("TOR", "NJD"),
    "202404110NYI": ("NYI", "MTL"),
    "202404110DAL": ("DAL", "WPG"),
    "202404110SEA": ("SEA", "SJS"),
    "202404110LAK": ("LAK", "CGY"),
    "202404120STL": ("STL", "CAR"),
    "202404120CHI": ("CHI", "NSH"),
    "202404120EDM": ("EDM", "ARI"),
    "202404120ANA": ("ANA", "CGY"),
    "202404120VEG": ("VEG", "MIN"),
    "202404130NYR": ("NYR", "NYI"),
    "202404130DAL": ("DAL", "SEA"),
    "202404130COL": ("COL", "WPG"),
    "202404130FLA": ("FLA", "BUF"),
    "202404130PHI": ("PHI", "NJD"),
    "202404130WSH": ("WSH", "TBL"),
    "202404130OTT": ("OTT", "MTL"),
    "202404130TOR": ("TOR", "DET"),
    "202404130NSH": ("NSH", "CBJ"),
    "202404130PIT": ("PIT", "BOS"),
    "202404130EDM": ("EDM", "VAN"),
    "202404130LAK": ("LAK", "ANA"),
    "202404130SJS": ("SJS", "MIN"),
    "202404140STL": ("STL", "SEA"),
    "202404140VEG": ("VEG", "COL"),
    "202404140CHI": ("CHI", "CAR"),
    "202404140CGY": ("CGY", "ARI"),
    "202404150DET": ("DET", "MTL"),
    "202404150NJD": ("NJD", "NYI"),
    "202404150PIT": ("PIT", "NSH"),
    "202404150TBL": ("TBL", "BUF"),
    "202404150WSH": ("WSH", "BOS"),
    "202404150NYR": ("NYR", "OTT"),
    "202404150EDM": ("EDM", "SJS"),
    "202404150LAK": ("LAK", "MIN"),
    "202404160BOS": ("BOS", "OTT"),
    "202404160CBJ": ("CBJ", "CAR"),
    "202404160FLA": ("FLA", "TOR"),
    "202404160MTL": ("MTL", "DET"),
    "202404160PHI": ("PHI", "WSH"),
    "202404160WPG": ("WPG", "SEA"),
    "202404160VEG": ("VEG", "CHI"),
    "202404160VAN": ("VAN", "CGY"),
    "202404170NYI": ("NYI", "PIT"),
    "202404170TBL": ("TBL", "TOR"),
    "202404170DAL": ("DAL", "STL"),
    "202404170ARI": ("ARI", "EDM"),
    "202404180MIN": ("MIN", "SEA"),
    "202404180WPG": ("WPG", "VAN"),
    "202404180CGY": ("CGY", "SJS"),
    "202404180COL": ("COL", "EDM"),
    "202404180VEG": ("VEG", "ANA"),
    "202404180LAK": ("LAK", "CHI"),
    "202410040BUF": ("BUF", "NJD"),
    "202410050NJD": ("NJD", "BUF"),
    "202410080SEA": ("SEA", "STL"),
    "202410080FLA": ("FLA", "BOS"),
    "202410080UTA": ("UTA", "CHI"),
    "202410090MTL": ("MTL", "TOR"),
    "202410090PIT": ("PIT", "NYR"),
    "202410090EDM": ("EDM", "WPG"),
    "202410090VAN": ("VAN", "CGY"),
    "202410090VEG": ("VEG", "COL"),
    "202410100BOS": ("BOS", "MTL"),
    "202410100BUF": ("BUF", "LAK"),
    "202410100OTT": ("OTT", "FLA"),
    "202410100DET": ("DET", "PIT"),
    "202410100NJD": ("NJD", "TOR"),
    "202410100NYI": ("NYI", "UTA"),
    "202410100NSH": ("NSH", "DAL"),
    "202410100MIN": ("MIN", "CBJ"),
    "202410100SJS": ("SJS", "STL"),
    "202410110CAR": ("CAR", "TBL"),
    "202410110WPG": ("WPG", "CHI"),
    "202410110VAN": ("VAN", "PHI"),
    "202410110VEG": ("VEG", "STL"),
    "202410120BOS": ("BOS", "LAK"),
    "202410120BUF": ("BUF", "FLA"),
    "202410120TOR": ("TOR", "PIT"),
    "202410120MTL": ("MTL", "OTT"),
    "202410120DET": ("DET", "NSH"),
    "202410120TBL": ("TBL", "CAR"),
    "202410120NYR": ("NYR", "UTA"),
    "202410120WSH": ("WSH", "NJD"),
    "202410120DAL": ("DAL", "NYI"),
    "202410120MIN": ("MIN", "SEA"),
    "202410120COL": ("COL", "CBJ"),
    "202410120CGY": ("CGY", "PHI"),
    "202410120EDM": ("EDM", "CHI"),
    "202410120SJS": ("SJS", "ANA"),
    "202410130WPG": ("WPG", "MIN"),
    "202410130DAL": ("DAL", "SEA"),
    "202410130EDM": ("EDM", "CGY"),
    "202410130VEG": ("VEG", "ANA"),
    "202410140BOS": ("BOS", "FLA"),
    "202410140OTT": ("OTT", "LAK"),
    "202410140NJD": ("NJD", "UTA"),
    "202410140NYR": ("NYR", "DET"),
    "202410140MTL": ("MTL", "PIT"),
    "202410140COL": ("COL", "NYI"),
    "202410150TBL": ("TBL", "VAN"),
    "202410150WSH": ("WSH", "VEG"),
    "202410150CAR": ("CAR", "NJD"),
    "202410150CBJ": ("CBJ", "FLA"),
    "202410150STL": ("STL", "MIN"),
    "202410150NSH": ("NSH", "SEA"),
    "202410150DAL": ("DAL", "SJS"),
    "202410150CGY": ("CGY", "CHI"),
    "202410150EDM": ("EDM", "PHI"),
    "202410160PIT": ("PIT", "BUF"),
    "202410160TOR": ("TOR", "LAK"),
    "202410160COL": ("COL", "BOS"),
    "202410160ANA": ("ANA", "UTA"),
    "202410170MTL": ("MTL", "LAK"),
    "202410170OTT": ("OTT", "NJD"),
    "202410170DET": ("DET", "NYR"),
    "202410170TBL": ("TBL", "VEG"),
    "202410170FLA": ("FLA", "VAN"),
    "202410170WSH": ("WSH", "DAL"),
    "202410170CBJ": ("CBJ", "BUF"),
    "202410170STL": ("STL", "NYI"),
    "202410170NSH": ("NSH", "EDM"),
    "202410170CHI": ("CHI", "SJS"),
    "202410170SEA": ("SEA", "PHI"),
    "202410180PIT": ("PIT", "CAR"),
    "202410180WPG": ("WPG", "SJS"),
    "202410180COL": ("COL", "ANA"),
    "202410190OTT": ("OTT", "TBL"),
    "202410190NSH": ("NSH", "DET"),
    "202410190DAL": ("DAL", "EDM"),
    "202410190FLA": ("FLA", "VEG"),
    "202410190TOR": ("TOR", "NYR"),
    "202410190NJD": ("NJD", "WSH"),
    "202410190NYI": ("NYI", "MTL"),
    "202410190PHI": ("PHI", "VAN"),
    "202410190CBJ": ("CBJ", "MIN"),
    "202410190STL": ("STL", "CAR"),
    "202410190CHI": ("CHI", "BUF"),
    "202410190UTA": ("UTA", "BOS"),
    "202410190SEA": ("SEA", "CGY"),
    "202410200WPG": ("WPG", "PIT"),
    "202410200SJS": ("SJS", "COL"),
    "202410200ANA": ("ANA", "LAK"),
    "202410210TOR": ("TOR", "TBL"),
    "202410220PHI": ("PHI", "WSH"),
    "202410220FLA": ("FLA", "MIN"),
    "202410220NJD": ("NJD", "TBL"),
    "202410220BUF": ("BUF", "DAL"),
    "202410220MTL": ("MTL", "NYR"),
    "202410220CBJ": ("CBJ", "TOR"),
    "202410220NYI": ("NYI", "DET"),
    "202410220STL": ("STL", "WPG"),
    "202410220CHI": ("CHI", "VAN"),
    "202410220NSH": ("NSH", "BOS"),
    "202410220CGY": ("CGY", "PIT"),
    "202410220EDM": ("EDM", "CAR"),
    "202410220UTA": ("UTA", "OTT"),
    "202410220ANA": ("ANA", "SJS"),
    "202410220SEA": ("SEA", "COL"),
    "202410220VEG": ("VEG", "LAK"),
    "202410230WSH": ("WSH", "PHI"),
    "202410240BOS": ("BOS", "DAL"),
    "202410240TOR": ("TOR", "STL"),
    "202410240DET": ("DET", "NJD"),
    "202410240TBL": ("TBL", "MIN"),
    "202410240NYR": ("NYR", "FLA"),
    "202410240CGY": ("CGY", "CAR"),
    "202410240UTA": ("UTA", "COL"),
    "202410240SEA": ("SEA", "WPG"),
    "202410240LAK": ("LAK", "SJS"),
    "202410250VEG": ("VEG", "OTT"),
    "202410250NJD": ("NJD", "NYI"),
    "202410250CHI": ("CHI", "NSH"),
    "202410250EDM": ("EDM", "PIT"),
    "202410260BUF": ("BUF", "DET"),
    "202410260PHI": ("PHI", "MIN"),
    "202410260LAK": ("LAK", "UTA"),
    "202410260BOS": ("BOS", "TOR"),
    "202410260MTL": ("MTL", "STL"),
    "202410260TBL": ("TBL", "WSH"),
    "202410260NYR": ("NYR", "ANA"),
    "202410260CGY": ("CGY", "WPG"),
    "202410260NYI": ("NYI", "FLA"),
    "202410260NSH": ("NSH", "CBJ"),
    "202410260DAL": ("DAL", "CHI"),
    "202410260VAN": ("VAN", "PIT"),
    "202410260VEG": ("VEG", "SJS"),
    "202410260SEA": ("SEA", "CAR"),
    "202410270DET": ("DET", "EDM"),
    "202410270NJD": ("NJD", "ANA"),
    "202410270PHI": ("PHI", "MTL"),
    "202410270COL": ("COL", "OTT"),
    "202410280BUF": ("BUF", "FLA"),
    "202410280TBL": ("TBL", "NSH"),
    "202410280CBJ": ("CBJ", "EDM"),
    "202410280WPG": ("WPG", "TOR"),
    "202410280COL": ("COL", "CHI"),
    "202410280UTA": ("UTA", "SJS"),
    "202410280VAN": ("VAN", "CAR"),
    "202410280VEG": ("VEG", "CGY"),
    "202410290BOS": ("BOS", "PHI"),
    "202410290MTL": ("MTL", "SEA"),
    "202410290OTT": ("OTT", "STL"),
    "202410290WSH": ("WSH", "NYR"),
    "202410290NYI": ("NYI", "ANA"),
    "202410290PIT": ("PIT", "MIN"),
    "202410290SJS": ("SJS", "LAK"),
    "202410300CBJ": ("CBJ", "NYI"),
    "202410300DET": ("DET", "WPG"),
    "202410300COL": ("COL", "TBL"),
    "202410300UTA": ("UTA", "CGY"),
    "202410300VAN": ("VAN", "NJD"),
    "202410300LAK": ("LAK", "VEG"),
    "202410310TOR": ("TOR", "SEA"),
    "202410310PHI": ("PHI", "STL"),
    "202410310PIT": ("PIT", "ANA"),
    "202410310WSH": ("WSH", "MTL"),
    "202410310CAR": ("CAR", "BOS"),
    "202410310NSH": ("NSH", "EDM"),
    "202410310SJS": ("SJS", "CHI"),
    "202411010BUF": ("BUF", "NYI"),
    "202411010NYR": ("NYR", "OTT"),
    "202411010CBJ": ("CBJ", "WPG"),
    "202411010MIN": ("MIN", "TBL"),
    "202411010DAL": ("DAL", "FLA"),
    "202411010CGY": ("CGY", "NJD"),
    "202411020PHI": ("PHI", "BOS"),
    "202411020LAK": ("LAK", "CHI"),
    "202411020WSH": ("WSH", "CBJ"),
    "202411020FLA": ("FLA", "DAL"),
    "202411020OTT": ("OTT", "SEA"),
    "202411020DET": ("DET", "BUF"),
    "202411020PIT": ("PIT", "MTL"),
    "202411020STL": ("STL", "TOR"),
    "202411020NSH": ("NSH", "COL"),
    "202411020VEG": ("VEG", "UTA"),
    "202411020SJS": ("SJS", "VAN"),
    "202411030NYR": ("NYR", "NYI"),
    "202411030WPG": ("WPG", "TBL"),
    "202411030BOS": ("BOS", "SEA"),
    "202411030CAR": ("CAR", "WSH"),
    "202411030MIN": ("MIN", "TOR"),
    "202411030CGY": ("CGY", "EDM"),
    "202411030ANA": ("ANA", "CHI"),
    "202411040NSH": ("NSH", "LAK"),
    "202411040EDM": ("EDM", "NJD"),
    "202411050BUF": ("BUF", "OTT"),
    "202411050TOR": ("TOR", "BOS"),
    "202411050MTL": ("MTL", "CGY"),
    "202411050CAR": ("CAR", "PHI"),
    "202411050NYI": ("NYI", "PIT"),
    "202411050STL": ("STL", "TBL"),
    "202411050MIN": ("MIN", "LAK"),
    "202411050WPG": ("WPG", "UTA"),
    "202411050COL": ("COL", "SEA"),
    "202411050ANA": ("ANA", "VAN"),
    "202411050SJS": ("SJS", "CBJ"),
    "202411060WSH": ("WSH", "NSH"),
    "202411060CHI": ("CHI", "DET"),
    "202411060EDM": ("EDM", "VEG"),
    "202411070BOS": ("BOS", "CGY"),
    "202411070OTT": ("OTT", "NYI"),
    "202411070TBL": ("TBL", "PHI"),
    "202411070FLA": ("FLA", "NSH"),
    "202411070NJD": ("NJD", "MTL"),
    "202411070NYR": ("NYR", "BUF"),
    "202411070CAR": ("CAR", "PIT"),
    "202411070STL": ("STL", "UTA"),
    "202411070DAL": ("DAL", "CHI"),
    "202411070WPG": ("WPG", "COL"),
    "202411070LAK": ("LAK", "VAN"),
    "202411070SJS": ("SJS", "MIN"),
    "202411080TOR": ("TOR", "DET"),
    "202411080WSH": ("WSH", "PIT"),
    "202411080ANA": ("ANA", "MIN"),
    "202411080SEA": ("SEA", "VEG"),
    "202411090BUF": ("BUF", "CGY"),
    "202411090FLA": ("FLA", "PHI"),
    "202411090BOS": ("BOS", "OTT"),
    "202411090TOR": ("TOR", "MTL"),
    "202411090DET": ("DET", "NYR"),
    "202411090STL": ("STL", "WSH"),
    "202411090WPG": ("WPG", "DAL"),
    "202411090NYI": ("NYI", "NJD"),
    "202411090NSH": ("NSH", "UTA"),
    "202411090COL": ("COL", "CAR"),
    "202411090LAK": ("LAK", "CBJ"),
    "202411090VAN": ("VAN", "EDM"),
    "202411100NJD": ("NJD", "SJS"),
    "202411100CHI": ("CHI", "MIN"),
    "202411100ANA": ("ANA", "CBJ"),
    "202411110BUF": ("BUF", "MTL"),
    "202411110PHI": ("PHI", "SJS"),
    "202411110PIT": ("PIT", "DAL"),
    "202411110CGY": ("CGY", "LAK"),
    "202411110COL": ("COL", "NSH"),
    "202411110VEG": ("VEG", "CAR"),
    "202411120TOR": ("TOR", "OTT"),
    "202411120FLA": ("FLA", "NJD"),
    "202411120NYR": ("NYR", "WPG"),
    "202411120STL": ("STL", "BOS"),
    "202411120EDM": ("EDM", "NYI"),
    "202411120VAN": ("VAN", "CGY"),
    "202411120SEA": ("SEA", "CBJ"),
    "202411130PIT": ("PIT", "DET"),
    "202411130WSH": ("WSH", "TOR"),
    "202411130UTA": ("UTA", "CAR"),
    "202411130COL": ("COL", "LAK"),
    "202411130ANA": ("ANA", "VEG"),
    "202411140BUF": ("BUF", "STL"),
    "202411140OTT": ("OTT", "PHI"),
    "202411140TBL": ("TBL", "WPG"),
    "202411140FLA": ("FLA", "NJD"),
    "202411140NYR": ("NYR", "SJS"),
    "202411140DAL": ("DAL", "BOS"),
    "202411140MIN": ("MIN", "MTL"),
    "202411140EDM": ("EDM", "NSH"),
    "202411140VAN": ("VAN", "NYI"),
    "202411140SEA": ("SEA", "CHI"),
    "202411150CBJ": ("CBJ", "PIT"),
    "202411150COL": ("COL", "WSH"),
    "202411150CGY": ("CGY", "NSH"),
    "202411150UTA": ("UTA", "VEG"),
    "202411150ANA": ("ANA", "DET"),
    "202411160BOS": ("BOS", "STL"),
    "202411160SEA": ("SEA", "NYI"),
    "202411160TOR": ("TOR", "EDM"),
    "202411160MTL": ("MTL", "CBJ"),
    "202411160TBL": ("TBL", "NJD"),
    "202411160FLA": ("FLA", "WPG"),
    "202411160PHI": ("PHI", "BUF"),
    "202411160PIT": ("PIT", "SJS"),
    "202411160CAR": ("CAR", "OTT"),
    "202411160MIN": ("MIN", "DAL"),
    "202411160LAK": ("LAK", "DET"),
    "202411160VAN": ("VAN", "CHI"),
    "202411170CAR": ("CAR", "STL"),
    "202411170VAN": ("VAN", "NSH"),
    "202411170VEG": ("VEG", "WSH"),
    "202411170SEA": ("SEA", "NYR"),
    "202411180BOS": ("BOS", "CBJ"),
    "202411180PHI": ("PHI", "COL"),
    "202411180MTL": ("MTL", "EDM"),
    "202411180DAL": ("DAL", "ANA"),
    "202411180UTA": ("UTA", "WSH"),
    "202411180SJS": ("SJS", "DET"),
    "202411190OTT": ("OTT", "EDM"),
    "202411190PIT": ("PIT", "TBL"),
    "202411190STL": ("STL", "MIN"),
    "202411190WPG": ("WPG", "FLA"),
    "202411190CHI": ("CHI", "ANA"),
    "202411190CGY": ("CGY", "NYI"),
    "202411190VAN": ("VAN", "NYR"),
    "202411200TOR": ("TOR", "VEG"),
    "202411200PHI": ("PHI", "CAR"),
    "202411200DAL": ("DAL", "SJS"),
    "202411200SEA": ("SEA", "NSH"),
    "202411200LAK": ("LAK", "BUF"),
    "202411210BOS": ("BOS", "UTA"),
    "202411210OTT": ("OTT", "VEG"),
    "202411210DET": ("DET", "NYI"),
    "202411210NJD": ("NJD", "CAR"),
    "202411210WSH": ("WSH", "COL"),
    "202411210CBJ": ("CBJ", "TBL"),
    "202411210STL": ("STL", "SJS"),
    "202411210CHI": ("CHI", "FLA"),
    "202411210CGY": ("CGY", "NYR"),
    "202411210EDM": ("EDM", "MIN"),
    "202411220PIT": ("PIT", "WPG"),
    "202411220ANA": ("ANA", "BUF"),
    "202411230PHI": ("PHI", "CHI"),
    "202411230CGY": ("CGY", "MIN"),
    "202411230LAK": ("LAK", "SEA"),
    "202411230FLA": ("FLA", "COL"),
    "202411230MTL": ("MTL", "VEG"),
    "202411230OTT": ("OTT", "VAN"),
    "202411230DET": ("DET", "BOS"),
    "202411230TBL": ("TBL", "DAL"),
    "202411230PIT": ("PIT", "UTA"),
    "202411230WSH": ("WSH", "NJD"),
    "202411230CBJ": ("CBJ", "CAR"),
    "202411230NSH": ("NSH", "WPG"),
    "202411230NYI": ("NYI", "STL"),
    "202411230SJS": ("SJS", "BUF"),
    "202411230EDM": ("EDM", "NYR"),
    "202411240TOR": ("TOR", "UTA"),
    "202411250TBL": ("TBL", "COL"),
    "202411250FLA": ("FLA", "WSH"),
    "202411250NJD": ("NJD", "NSH"),
    "202411250NYR": ("NYR", "STL"),
    "202411250PHI": ("PHI", "VEG"),
    "202411250CAR": ("CAR", "DAL"),
    "202411250OTT": ("OTT", "CGY"),
    "202411250NYI": ("NYI", "DET"),
    "202411250MIN": ("MIN", "WPG"),
    "202411250ANA": ("ANA", "SEA"),
    "202411250SJS": ("SJS", "LAK"),
    "202411260BOS": ("BOS", "VAN"),
    "202411260MTL": ("MTL", "UTA"),
    "202411270BUF": ("BUF", "MIN"),
    "202411270NJD": ("NJD", "STL"),
    "202411270CAR": ("CAR", "NYR"),
    "202411270DET": ("DET", "CGY"),
    "202411270TBL": ("TBL", "WSH"),
    "202411270FLA": ("FLA", "TOR"),
    "202411270NYI": ("NYI", "BOS"),
    "202411270PIT": ("PIT", "VAN"),
    "202411270CBJ": ("CBJ", "MTL"),
    "202411270NSH": ("NSH", "PHI"),
    "202411270CHI": ("CHI", "DAL"),
    "202411270COL": ("COL", "VEG"),
    "202411270LAK": ("LAK", "WPG"),
    "202411270SEA": ("SEA", "ANA"),
    "202411270SJS": ("SJS", "OTT"),
    "202411290PHI": ("PHI", "NYR"),
    "202411290MIN": ("MIN", "CHI"),
    "202411290BUF": ("BUF", "VAN"),
    "202411290DET": ("DET", "NJD"),
    "202411290WSH": ("WSH", "NYI"),
    "202411290CAR": ("CAR", "FLA"),
    "202411290CBJ": ("CBJ", "CGY"),
    "202411290NSH": ("NSH", "TBL"),
    "202411290ANA": ("ANA", "LAK"),
    "202411290SJS": ("SJS", "SEA"),
    "202411290BOS": ("BOS", "PIT"),
    "202411290DAL": ("DAL", "COL"),
    "202411290VEG": ("VEG", "WPG"),
    "202411290UTA": ("UTA", "EDM"),
    "202411300NYR": ("NYR", "MTL"),
    "202411300FLA": ("FLA", "CAR"),
    "202411300TBL": ("TBL", "TOR"),
    "202411300NJD": ("NJD", "WSH"),
    "202411300PIT": ("PIT", "CGY"),
    "202411300STL": ("STL", "PHI"),
    "202411300LAK": ("LAK", "OTT"),
    "202411300NYI": ("NYI", "BUF"),
    "202411300MIN": ("MIN", "NSH"),
    "202411300COL": ("COL", "EDM"),
    "202411300VEG": ("VEG", "UTA"),
    "202411300SEA": ("SEA", "SJS"),
    "202412010DET": ("DET", "VAN"),
    "202412010BOS": ("BOS", "MTL"),
    "202412010CHI": ("CHI", "CBJ"),
    "202412010DAL": ("DAL", "WPG"),
    "202412010ANA": ("ANA", "OTT"),
    "202412020NYR": ("NYR", "NJD"),
    "202412020TOR": ("TOR", "CHI"),
    "202412020UTA": ("UTA", "DAL")
}

base_path = r"C:\Users\ashle\Documents\Projects\hockey"

skaters_columns = [
    "Season", "Game", "GameID", "Date", "Player", "PlayerID", "Team", "TeamName", "Is_Home", "Opp", "OppName", "DEC", "GA", "SA", "SV", "SV%", "SO", "PIM", "TOI"
]

# File paths for the CSV outputs
base_path = r"C:\Users\ashle\Documents\Projects\hockey"
file_paths = {
    "skaters": os.path.join(base_path, "goalies.csv")
}

# Initialize lists to collect data
skaters_data = []

for game_id, (home_team, away_team) in games_info.items():
    url = f"https://www.hockey-reference.com/boxscores/{game_id}.html"

    try:
        print(f"Processing game ID {game_id} - Home Team: {home_team}, Away Team: {away_team}")
        html_content = fetch_webpage(url)
        soup = BeautifulSoup(html_content, 'html.parser')
        
        # Get full team names
        home_team_section = soup.select_one(f"#{home_team}_skaters_sh")
        away_team_section = soup.select_one(f"#{away_team}_skaters_sh")
        home_team_name = home_team_section.find("h2").get_text(strip=True) if home_team_section else "Unknown"
        away_team_name = away_team_section.find("h2").get_text(strip=True) if away_team_section else "Unknown"

        # Extract skaters table
        for team, team_name, is_home in [
            (home_team, home_team_name, True),
            (away_team, away_team_name, False),
        ]:
            
            table_selector = f"#{team}_goalies"
            table = soup.select_one(table_selector)
            if table:
                # Filter out "Empty Net" rows
                valid_rows = table.select("tbody tr:not([class='thead'])")
                valid_rows = [
                    row for row in valid_rows 
                    if row.find("td", {"data-stat": "player"}).get_text(strip=True) != "Empty Net"
                ]

                # Reconstruct the table with only valid rows
                filtered_table_html = '<table><thead>{}</thead><tbody>{}</tbody></table>'.format(
                    str(table.select_one("thead")),
                    "".join([str(row) for row in valid_rows])
                )
                
                df = pd.read_html(StringIO(filtered_table_html), encoding="utf-8")[0]
                headers = [th.get_text(strip=True) for th in table.select("thead tr")[1].find_all("th")]
                df.columns = headers
                
                # Fix encoding issues in player names
                df["Player"] = df["Player"].str.encode('latin1').str.decode('utf-8', errors='ignore')

                # Keep only the desired columns
                df = df[["Rk", "Player", "DEC", "GA", "SA", "SV", "SV%", "SO", "PIM", "TOI"]]

                # Convert TOI to decimal format
                if "TOI" in df.columns:
                    df["TOI"] = df["TOI"].apply(convert_toi_to_decimal)
                    
                df.insert(0, "Season", "")
                df.insert(1, "Game", f"{home_team} vs {away_team}")
                df.insert(2, "GameID", game_id)
                df.insert(3, "Date", extract_date_from_game_id(game_id))
                
                player_ids = [cell.get("data-append-csv") for cell in table.select("tbody tr td[data-append-csv]")]
                df.insert(df.columns.get_loc("Player") + 1, "PlayerID", player_ids + [None] * (len(df) - len(player_ids)))
                df.insert(df.columns.get_loc("Player") + 2, "Team", home_team if is_home else away_team)
                df.insert(df.columns.get_loc("Player") + 3, "TeamName", home_team_name if is_home else away_team_name)
                df.insert(df.columns.get_loc("Player") + 4, "Is_Home", 1 if is_home else 0)
                df.insert(df.columns.get_loc("Player") + 5, "Opp", away_team if is_home else home_team)
                df.insert(df.columns.get_loc("Player") + 6, "OppName", away_team_name if is_home else home_team_name)
                
                df = df.reindex(columns=skaters_columns, fill_value=None)

                skaters_data.append(df)

        # Wait to avoid rate limiting
        time.sleep(3)
        
    except requests.RequestException as e:
        print(f"Error fetching data for game ID {game_id}: {e}")
    except Exception as e:
        print(f"Error processing data for game ID {game_id}: {e}")


# Merge skaters_data and adv_skaters_data
if skaters_data:
    skaters_df = pd.concat(skaters_data, ignore_index=True)

    # Reorder columns according to the specified schema
    merged_columns = [
        "Season", "Game", "GameID", "Date", "Player", "PlayerID", "Team", "TeamName", "Is_Home", "Opp", "OppName", "DEC", "GA", "SA", "SV", "SV%", "SO", "PIM", "TOI"
    ]
    skaters_df = skaters_df.reindex(columns=merged_columns)

    # Save the merged DataFrame to a single CSV file
    merged_file_path = os.path.join(base_path, "goalies.csv")
    skaters_df.to_csv(merged_file_path, index=False, encoding="utf-8")
    print(f"Merged data successfully saved to {merged_file_path}")
else:
    print("Insufficient data to merge. Ensure both skaters and advanced skaters tables are populated.")
